<div class="home-page">
  <div class="home-period-controls">
    <button
      *ngFor="let p of periods"
      class="home-period-button"
      [class.active]="selectedPeriod() === p.value"
      (click)="selectedPeriod.set(p.value)">
      {{ p.label }}
    </button>
  </div>

  <div class="home-layout">
    <div class="home-content">
      <!-- Форма добавления нового item -->
      <div class="home-form">
        <form (submit)="add(); $event.preventDefault()">
          <div class="form-row">
            <input 
              type="text" 
              [(ngModel)]="title" 
              name="title" 
              placeholder="Название категории"
              required />
            <select [(ngModel)]="category" name="category">
              <option value="income">Доход</option>
              <option value="expense">Расход</option>
            </select>
            <button type="submit">Добавить</button>
          </div>
        </form>
      </div>

      <!-- Список items -->
      <div class="items-list">
        <div 
          *ngFor="let item of items()"
          class="items-item">
          <div class="items-item-content" (click)="open(item.id)">
            <div class="items-item-title">{{ item.title }}</div>
            <div class="items-item-meta">
              <span class="items-item-date">
                Обновлено: {{ item.lastUpdated | localDate:'short' }}
              </span>
            </div>
          </div>
          <div class="items-item-actions">
            <div 
              class="items-item-amount"
              [class.income]="item.category === 'income'"
              [class.expense]="item.category === 'expense'">
              {{ item.total | number:'1.2-2' }} ₽
            </div>
            <button 
              class="delete-button"
              (click)="delete(item.id, $event)"
              title="Удалить категорию">
              ×
            </button>
          </div>
        </div>
        
        <!-- Пустое состояние -->
        <div *ngIf="items().length === 0" class="items-empty">
          <p>Нет категорий. Создайте первую категорию для отслеживания финансов.</p>
        </div>
      </div>
    </div>

    <!-- График для десктопа -->
    <div class="home-chart desktop-chart">
      <div class="home-charts-container">
        <app-pie-chart
          [income]="statistics().income"
          [expense]="statistics().expense">
        </app-pie-chart>
      </div>
    </div>
  </div>

  <!-- График для мобильных (аккордеон) -->
  <div class="mobile-chart">
    <button class="accordion-toggle" (click)="toggleMobileChart()">
      {{ showMobileChart ? 'Скрыть график' : 'Показать график' }}
    </button>
    <div class="mobile-chart-panel" [class.open]="showMobileChart">
      <div class="mobile-charts-container">
        <app-pie-chart
          [income]="statistics().income"
          [expense]="statistics().expense">
        </app-pie-chart>
      </div>
    </div>
  </div>
</div>
