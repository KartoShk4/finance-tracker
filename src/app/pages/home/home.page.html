<div class="home-page">
  <!-- –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ -->
  <div *ngIf="!authService.isAuthenticated()" class="welcome-section">
    <div class="welcome-content">
      <h1 class="welcome-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Finance Tracker</h1>
      <p class="welcome-description">
        –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏—á–Ω—ã–º–∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏. –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã,
        –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Å–≤–æ–∏ —Ç—Ä–∞—Ç—ã —Å –ø–æ–º–æ—â—å—é –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.
      </p>
      
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">üìä</div>
          <h3>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</h3>
          <p>–ù–∞–≥–ª—è–¥–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤–∞—à–∏—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üìÅ</div>
          <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
          <p>–û—Ä–≥–∞–Ω–∏–∑—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É—á–µ—Ç–∞</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üè∑Ô∏è</div>
          <h3>–¢–µ–≥–∏</h3>
          <p>–î–æ–±–∞–≤–ª—è–π—Ç–µ —Ç–µ–≥–∏ –∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º –¥–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">üìà</div>
          <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
          <p>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã –∑–∞ —Ä–∞–∑–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã –≤—Ä–µ–º–µ–Ω–∏</p>
        </div>
      </div>

      <div class="demo-charts-section">
        <h2 class="section-title">–ü—Ä–∏–º–µ—Ä—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤</h2>
        <p class="section-description">
          –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
          –ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –≤–∞—à–µ–º –∞–∫–∫–∞—É–Ω—Ç–µ.
        </p>
        
        <div class="home-period-controls">
          <button
            *ngFor="let p of periods"
            class="home-period-button"
            [class.active]="selectedPeriod() === p.value"
            (click)="selectedPeriod.set(p.value)">
            {{ p.label }}
          </button>
        </div>
        
        <!-- –ü—Ä–∏–º–µ—Ä—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Å –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–º–∏ -->
        <div class="demo-charts-container">
          <app-pie-chart
            [income]="demoStatistics().income"
            [expense]="demoStatistics().expense">
          </app-pie-chart>
          <app-categories-chart
            [categories]="demoCategoriesChartData()">
          </app-categories-chart>
        </div>
      </div>

      <div class="auth-cta">
        <h2 class="cta-title">–ù–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Finance Tracker</h2>
        <p class="cta-description">
          –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ VK, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        </p>
        <app-vk-login></app-vk-login>
      </div>
    </div>
  </div>

  <!-- –î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
  <div *ngIf="authService.isAuthenticated()" class="home-layout">
    <div class="home-content">
      <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ item -->
      <div class="home-form">
        <form (submit)="add($event)">
          <div class="form-row">
            <input 
              type="text" 
              [(ngModel)]="title" 
              name="title" 
              placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
              required />
            <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
          </div>
        </form>
      </div>

      <!-- –°–ø–∏—Å–æ–∫ items -->
      <div class="items-list" cdkDropList (cdkDropListDropped)="onDrop($event)">
        <div 
          *ngFor="let item of items(); trackBy: trackByItemId"
          class="items-item"
          [class.favorite]="item.isFavorite"
          [cdkDragDisabled]="isMobile() && !dragActivated"
          cdkDrag
          (touchstart)="onTouchStart($event, item)"
          (touchend)="onTouchEnd($event)"
          (touchmove)="onTouchMove($event)">
          <div class="items-item-content" (click)="!isDragging && !dragActivated && open(item.id)">
            <button 
              class="favorite-button"
              [class.active]="item.isFavorite"
              (click)="toggleFavorite(item.id, $event)"
              title="{{ item.isFavorite ? '–£–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : '–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ' }}">
              ‚òÖ
            </button>
            <div class="items-item-info">
              <div class="items-item-title">{{ item.title }}</div>
              <div class="items-item-meta">
                <span class="items-item-date">
                  –û–±–Ω–æ–≤–ª–µ–Ω–æ: {{ item.lastUpdated | localDate:'short' }}
                </span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
        <div *ngIf="items().length === 0" class="items-empty">
          <p>–ù–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤.</p>
        </div>
      </div>
    </div>

    <!-- –ì—Ä–∞—Ñ–∏–∫ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ -->
    <div class="home-chart desktop-chart">
      <div class="home-charts-container">
        <div class="home-period-controls">
          <button
            *ngFor="let p of periods"
            class="home-period-button"
            [class.active]="selectedPeriod() === p.value"
            (click)="selectedPeriod.set(p.value)">
            {{ p.label }}
          </button>
        </div>
        <!-- –ü–µ—Ä–≤—ã–π –≥—Ä–∞—Ñ–∏–∫: –æ–±—â–∏–µ –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã -->
        <app-pie-chart
          [income]="statistics().income"
          [expense]="statistics().expense">
        </app-pie-chart>
        <!-- –í—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫: –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –∏—Ö –¥–æ—Ö–æ–¥–∞–º–∏ –∏ —Ä–∞—Å—Ö–æ–¥–∞–º–∏ -->
        <app-categories-chart
          [categories]="categoriesChartData()">
        </app-categories-chart>
      </div>
    </div>
  </div>

  <!-- –ì—Ä–∞—Ñ–∏–∫ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (–∞–∫–∫–æ—Ä–¥–µ–æ–Ω) -->
  <div *ngIf="authService.isAuthenticated()" class="mobile-chart">
    <button class="accordion-toggle" (click)="toggleMobileChart()">
      {{ showMobileChart ? '–°–∫—Ä—ã—Ç—å –≥—Ä–∞—Ñ–∏–∫' : '–ü–æ–∫–∞–∑–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫' }}
    </button>
    <div class="mobile-chart-panel" [class.open]="showMobileChart">
      <div class="mobile-charts-container">
        <div class="home-period-controls">
          <button
            *ngFor="let p of periods"
            class="home-period-button"
            [class.active]="selectedPeriod() === p.value"
            (click)="selectedPeriod.set(p.value)">
            {{ p.label }}
          </button>
        </div>
        <!-- –ü–µ—Ä–≤—ã–π –≥—Ä–∞—Ñ–∏–∫: –æ–±—â–∏–µ –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã -->
        <app-pie-chart
          [income]="statistics().income"
          [expense]="statistics().expense">
        </app-pie-chart>
        <!-- –í—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫: –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –∏—Ö –¥–æ—Ö–æ–¥–∞–º–∏ –∏ —Ä–∞—Å—Ö–æ–¥–∞–º–∏ -->
        <app-categories-chart
          [categories]="categoriesChartData()">
        </app-categories-chart>
      </div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –∏–∑–±—Ä–∞–Ω–Ω–æ–º -->
  <app-modal
    [isOpen]="showFavoriteModal()"
    title="–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è"
    [showCancel]="false"
    confirmText="–ü–æ–Ω—è—Ç–Ω–æ"
    (confirm)="showFavoriteModal.set(false)"
    (closeEvent)="showFavoriteModal.set(false)">
    <p>–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω—è—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ.</p>
    <p style="margin-top: var(--space-md); color: var(--color-text-secondary);">
      –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ VK, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    </p>
  </app-modal>
</div>
