<div class="home-page">
  <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞ -->
  <div *ngIf="isDemoMode()" class="demo-banner">
    <div class="demo-banner-content">
      <span class="demo-icon">üé≠</span>
      <span class="demo-text">–î–µ–º–æ-—Ä–µ–∂–∏–º: –≤—ã –≤–∏–¥–∏—Ç–µ –ø—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–≤–æ–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.</span>
      <button class="demo-login-btn" (click)="scrollToTop()">–í–æ–π—Ç–∏</button>
    </div>
  </div>

  <div class="home-layout">
    <div class="home-content">
      <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ item -->
      <div class="home-form" [class.demo-disabled]="isDemoMode()">
        <form (submit)="add(); $event.preventDefault()">
          <div class="form-row">
            <input 
              type="text" 
              [(ngModel)]="title" 
              name="title" 
              [placeholder]="isDemoMode() ? '–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏' : '–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏'"
              [disabled]="isDemoMode()"
              required />
            <select [(ngModel)]="category" name="category" [disabled]="isDemoMode()">
              <option value="income">–î–æ—Ö–æ–¥</option>
              <option value="expense">–†–∞—Å—Ö–æ–¥</option>
            </select>
            <button type="submit" [disabled]="isDemoMode()">–î–æ–±–∞–≤–∏—Ç—å</button>
          </div>
        </form>
        <div *ngIf="isDemoMode()" class="demo-form-hint">
          –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        </div>
      </div>

      <!-- –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
      <div class="home-filter">
        <button
          class="filter-button"
          [class.active]="categoryFilter() === 'all'"
          (click)="categoryFilter.set('all')">
          –í—Å–µ
        </button>
        <button
          class="filter-button"
          [class.active]="categoryFilter() === 'income'"
          (click)="categoryFilter.set('income')">
          –î–æ—Ö–æ–¥—ã
        </button>
        <button
          class="filter-button"
          [class.active]="categoryFilter() === 'expense'"
          (click)="categoryFilter.set('expense')">
          –†–∞—Å—Ö–æ–¥—ã
        </button>
      </div>

      <!-- –°–ø–∏—Å–æ–∫ items -->
      <div class="items-list" cdkDropList (cdkDropListDropped)="onDrop($event)">
        <div 
          *ngFor="let item of items(); trackBy: trackByItemId"
          class="items-item"
          [class.favorite]="item.isFavorite"
          cdkDrag>
          <div class="items-item-content" (click)="open(item.id)">
            <button 
              class="favorite-button"
              [class.active]="item.isFavorite"
              (click)="toggleFavorite(item.id, $event)"
              title="{{ item.isFavorite ? '–£–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : '–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ' }}">
              ‚òÖ
            </button>
            <div class="items-item-info">
              <div class="items-item-title">{{ item.title }}</div>
              <div class="items-item-meta">
                <span class="items-item-date">
                  –û–±–Ω–æ–≤–ª–µ–Ω–æ: {{ item.lastUpdated | localDate:'short' }}
                </span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
        <div *ngIf="items().length === 0" class="items-empty">
          <p>–ù–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤.</p>
        </div>
      </div>
    </div>

    <!-- –ì—Ä–∞—Ñ–∏–∫ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ -->
    <div class="home-chart desktop-chart">
      <div class="home-charts-container">
        <div class="home-period-controls">
          <button
            *ngFor="let p of periods"
            class="home-period-button"
            [class.active]="selectedPeriod() === p.value"
            (click)="selectedPeriod.set(p.value)">
            {{ p.label }}
          </button>
        </div>
        <app-pie-chart
          [income]="statistics().income"
          [expense]="statistics().expense">
        </app-pie-chart>
      </div>
    </div>
  </div>

  <!-- –ì—Ä–∞—Ñ–∏–∫ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö (–∞–∫–∫–æ—Ä–¥–µ–æ–Ω) -->
  <div class="mobile-chart">
    <button class="accordion-toggle" (click)="toggleMobileChart()">
      {{ showMobileChart ? '–°–∫—Ä—ã—Ç—å –≥—Ä–∞—Ñ–∏–∫' : '–ü–æ–∫–∞–∑–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫' }}
    </button>
    <div class="mobile-chart-panel" [class.open]="showMobileChart">
      <div class="mobile-charts-container">
        <div class="home-period-controls">
          <button
            *ngFor="let p of periods"
            class="home-period-button"
            [class.active]="selectedPeriod() === p.value"
            (click)="selectedPeriod.set(p.value)">
            {{ p.label }}
          </button>
        </div>
        <app-pie-chart
          [income]="statistics().income"
          [expense]="statistics().expense">
        </app-pie-chart>
      </div>
    </div>
  </div>
</div>
